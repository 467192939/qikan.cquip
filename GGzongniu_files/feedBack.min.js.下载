(function(){var n={init:function(){this.bindCheckCode();this.btnCancel();this.btnSend()},showFeedBack:function(){$("#txtFeedbackTitle").val("");$("#txtFeedbackEmail").val("");$("#txtFeedbackDescription").val("");$("#txtFeedbackCode").val("")},hideFeedBack:function(){$("#showFeedBack").hide();layer.close(layer.index)},bindCheckCode:function(){$("#imgFeedBackVerifyCode").attr("src","/RegistLogin/AuthCode?key=Feedback&time="+(new Date).getTime());$("#imgFeedBackVerifyCode").bind("click",function(){this.src="/RegistLogin/AuthCode?key=Feedback&time="+(new Date).getTime()});$("#btnFeedBackVerifyCode").bind("click",function(){$("#imgFeedBackVerifyCode").attr("src","/RegistLogin/AuthCode?key=Feedback&time="+(new Date).getTime())})},btnCancel:function(){$("#btnCancel").bind("click",function(){n.hideFeedBack()})},btnSend:function(){$("#btnSend").bind("click",function(){var t={},i;if(t.title=$("#txtFeedbackTitle").val(),t.email=$("#txtFeedbackEmail").val(),t.code=$.trim($("#txtFeedbackCode").val()),t.Descript=$.trim($("#txtFeedbackDescription").val()),i=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,t.title=="")return $(".inlineTitle-tip").html("标题不能为空!"),$("#txtFeedbackTitle").focus(),!1;if(t.email=="")return $(".inlineEmail-tip").html("邮件不能为空!"),$("#txtFeedbackEmail").focus(),!1;if(i.test(t.email)){if(t.code=="")return $(".inlineFeedBackVerifyCode-tip").html("验证码不能为空!"),$("#txtFeedbackCode").focus(),!1;$.ajax({url:"/UserRelated/UserFeedback",data:t,type:"post",dataType:"json",success:function(t){$("#imgFeedBackVerifyCode").trigger("click");t.Result==0?($(".inlineFeedBackVerifyCode-tip").html(t.PromptMsg),$("#txtFeedbackCode").focus()):(alert("反馈意见已提交成功，感谢您的反馈！"),n.hideFeedBack())}})}else return $(".inlineEmail-tip").html("邮件格式错误!"),$("#txtFeedbackEmail").focus(),!1})}};$(document).ready(function(){n.init();layui.use(["element","layer","form"],function(){var t=layui.$,i=layui.layer;t("#feedBack").bind("click",function(){i.open({type:1,title:"意见反馈",area:["700px","400px"],content:t("#showFeedBack"),shadeClose:!0,success:function(){n.showFeedBack()},cancel:function(){return n.hideFeedBack(),!1}})})})})})();